# Mounting an SSD to the Master Node for MinIO Storage

This guide will walk you through the steps to mount an SSD to your master node and configure Kubernetes to use it for MinIO's persistent storage. The goal is to have MinIO store its data on the external SSD, which is exclusively mounted on the master node for optimized storage.

## Mount the SSD to the Master Node

Before configuring Kubernetes, we need to mount the SSD to the master node. This is something that likely could be automated via Ansible, but can easily be done manually since it is only for one node.

### Steps:

**1. Connect the SSD to your Master Node:**

- Physically connect your SSD to the master node (via USB, SATA, or other connections).

**2. Identify the SSD:**

- SSH into your master node and run the following command to list all connected disks:
    ```bash
    lsblk
    ```
- Identify your SSD device, typically named `/dev/sdX` (replace `X` with the correct letter).

**3. Create a Partition and Format the SSD (if not already done):**

- Create a partition on the SSD:
    ```bash
    sudo fdisk /dev/sdX
    ```
- Format the partition with ext4 or another filesystem:
    ```bash
    sudo mkfs.ext4 /dev/sdX1  # Replace /dev/sdX1 with your SSD partition
    ```

**4. Mount the SSD to a Directory:**

- Create a directory where you want to mount the SSD:
    ```bash
    sudo mkdir -p /mnt/minio-data
    ```
- Mount the SSD to the directory:
    ```bash
    sudo mount /dev/sdX1 /mnt/minio-data
    ```

**5. Make the Mount Persistent:**

- Add the mount entry to `/etc/fstab` to ensure the SSD is remounted automatically after a reboot:
    ```bash
    sudo nano /etc/fstab
    ```
- Add the following line:
    ```bash
    /dev/sdX1  /mnt/minio-data  ext4  defaults  0  2
    ```

## Why Configure Storage Exclusively on One Node?

There are several reasons why you might want to configure MinIO storage exclusively on the master node with an external SSD:

### **Dedicated Storage:**

- The SSD provides dedicated, high-performance storage for MinIO. Using a master node with exclusive access to the external drive ensures that this storage is always available and optimized for MinIO's data needs.

### **Improved Performance:**

- SSDs offer much faster read/write speeds compared to standard hard drives or network-based storage. By using the master node with a local SSD, you reduce the overhead of network I/O, which can significantly improve MinIO’s performance.

### **High Availability Considerations:**

- While it's common to configure distributed storage across multiple nodes in a Kubernetes cluster, for MinIO (especially in testing or small environments), it might be desirable to use a single-node configuration. This simplifies the setup and reduces complexity for specific use cases, like object storage where high availability isn't yet a concern.

### **Master Node as a Dedicated Resource:**

- In Kubernetes, the master node typically handles cluster management and is not used for running regular workloads. By dedicating the master node’s resources (including storage) to MinIO, you free up other nodes for regular workloads, balancing the cluster's resource utilization.

---

# Logging Configuration for MinIO

In the current setup, logs are being stored in MinIO and organized by prefixes based on the job name, date, and time (in UTC). The logs are being sent to the `argo-logs` bucket. The log path is dynamically generated by the Python code in the scraping scripts.

## How Logs Are Stored:

The log path is structured with the following components:
* `job_name`: The name of the job (e.g., "example-job").
* `date_str`: The date in `MM-DD-YYYY` format (e.g., "03-18-2025").
* `time_str`: The time in `HH-MM` format (e.g., "14-30").

### UTC Timestamps:

The timestamps used for the logs are in UTC. So, when the log path is generated, it reflects the UTC date and time at the moment the log is created.

The resulting log path will look something like:

```bash
argo-logs/example-job/03-18-2025/14-30.log
```

### Example:
If the job name is `data-processing`, and the log is being generated on March 18, 2025, at 2:30 PM UTC, the log path will be:

```bash
argo-logs/data-processing/03-18-2025/14-30.log
```

This structure allows for organized and easy retrieval of logs, ensuring that logs are stored in separate directories based on both job name and timestamp in UTC.

## Accessing Logs in the MinIO Bucket via the MinIO UI
To access the logs stored in the MinIO bucket via the MinIO UI, follow these steps:

### Step 1: Port Forward the MinIO Service
You need to port-forward the MinIO service to access the MinIO UI locally. Run the following command to forward port 9001:

```bash
kubectl port-forward svc/minio 9001:9001 -n argo
```

This will forward the MinIO UI to localhost:9001.

### Step 2: Access the MinIO UI

Open a web browser and navigate to http://localhost:9001. This will load the MinIO web UI. Login using the credentials specified at time of deployment in the `secret.yaml` file.

### Step 3: Navigate to the argo-logs Bucket
Once logged in, you can browse the `argo-logs` bucket. Here, you will find the logs organized by the job name, date, and time, as described in the Logging Configuration section.
